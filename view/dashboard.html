<!doctype html>

<html lang="en">
  <head>
    <!-- League Spartan font links -->
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=League+Spartan:wght@100..900&display=swap" rel="stylesheet">
    <!-- Font-Awesome Icons link -->
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.1/css/all.min.css" integrity="sha512-DTOQO9RWCH3ppGqcWaEA1BIZOC6xxalwEsw9c2QQeAIftl+Vegovlnee1c9QX4TctnWMn13TZye+giMm8e2LwA==" crossorigin="anonymous" referrerpolicy="no-referrer" />
    <!-- Required meta tags -->
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
    <!-- CSS -->
    <link rel="stylesheet" href="styles/style.css">
    <!-- Bootstrap CSS -->
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@4.1.3/dist/css/bootstrap.min.css"
      integrity="sha384-MCw98/SFnGE8fJT3GXwEOngsV7Zt27NXFoaoApmYm81iuXoPkFOJwJ8ERdknLPMO" crossorigin="anonymous">
    <title>Artex</title>
    <script src="https://code.jquery.com/jquery-3.6.0.min.js"></script>
  </head>

  <body>
    <header class="header">
        <img class="logo-picture" src="images/logo.png" alt="" width="80px;" height="80px;">
        <h3 style="padding-top:10px; padding-left: 5px; font-size: 30px;">Artex</h3>
      </header>
    <!--Orders tab-->
    <div class="container" style="margin-top: 20px;">
        <h2 style="text-align: center; width: 100%;">Orders</h2>
        <div style="background-color: rgb(236, 236, 236); padding-top: 20px; padding-bottom: 40px;">
            <div class="row" style="width: 100%; margin: 10px;">
                <div class="col-md-12">
                    <h3 class="column-title">Active</h3>
                    <table style="width: 100%;" id="orders-table">
                        <thead>
                            <th>ID</th>
                            <th>Date</th>
                            <th>Type</th>
                            <th>Color</th>
                            <th>Size</th>
                            <th>Embroidery</th>
                            <th>Status</th>
                        </thead>
                        <tbody>
                            <!--Orders php insertions go here-->
                        </tbody>
                    </table>
                </div>
            </div>
        </div>
    </div>

    <!--Inventory tab-->
    <div class="container" style="margin-top: 20px;">
        <h2 style="text-align: center; width: 100%;">Inventory</h2>
        <div class="row" style="background-color: rgb(236, 236, 236); padding-top: 20px; padding-bottom: 20px;">
            <div class="col-md-12">
                
                <!--Stock table-->
                <h3 class="column-title">Stock</h3>
                <form action="../controllers/php/update_inventory.php" method="post">
                    <table style="width: 100%;" id="inventory-table">
                        <thead>
                            <tr>
                                <th>ID</th>
                                <th>Type</th>
                                <th>Size</th>
                                <th>Color</th>
                                <th style="width: 40px;">Quantity</th>
                            </tr>
                        </thead>
                        <tbody>
                            <!--Inventory items-->
                        </tbody>
                    </table>
                    <button type="submit" id="update-btn" class="product-card-button" style="float: right; margin-right: 10%; margin-top: 8px; border-radius: 8px; width: 120px; color: white; display: none;">
                        Update stock
                    </button>
                </form>
                <button onclick="show_iadd_bar()" class="product-card-button" style="float: left; margin-left: 42%; margin-top: 8px; border-radius: 8px; width: 80px; height: 30px;">
                    <i class="fa-regular fa-plus fa-lg" style="color: white;"></i>
                </button>

                <!--Item adding-->
                <div class="row" id="item-add" style="margin-top: 20px; display: none;">
                    <div class="col-md-12">
                        <form action="../controllers/php/add_item.php" method="post">
                            <table style="width: 100%;">
                                <thead>
                                    <tr>
                                        <th>Type</th>
                                        <th>Size</th>
                                        <th>Color</th>
                                        <th>Quantity</th>
                                    </tr>
                                </thead>
                                <tbody>
                                    <tr>
                                        <td>
                                            <select name="garment" id="gar-sel">
                                                <option value="select">select</option>
                                                <option value="P">T-shirt</option>
                                                <option value="S">Hoodie</option>
                                                <option value="M">Long-sleeved</option>
                                                <option value="T">Sleeveless</option>
                                                <option value="C">Cap</option>
                                            </select>
                                        </td>
                                        <td>
                                            <select name="size" id="size-sel">
                                            </select>
                                        </td>
                                        <td>
                                            <select name="color" id="color-sel">
                                            </select>
                                        </td>
                                        <td>
                                            <input type="number" name="quantity">
                                        </td>
                                        <td class="nopad-td">
                                            <button class="dashb-button" type="submit"><i class="fa-solid fa-check"></i></button>
                                        </td>
                                    </tr>
                                </tbody>
                            </table>
                        </form>
                    </div>
                </div>
                
                <div class="row" style="width: 100%; margin-top: 80px;">
                    <div class="col-md-12">
                        <button onclick='show_options()' style="float: right; border-radius: 8px; background-color: #316639; border: 0; color: white; padding: 6px; margin-right: 12px;">
                            Show constraints
                        </button>
                    </div>
                </div>

                <!--Clothing constraints-->
                <div id="specs" style="display: none; margin-top: 80px; padding: 50px;">
                    <div class="container" style="margin-top: 20px;">
                        <form action="../controllers/php/update_constraints.php" method="post">
                            <!--T-shirts-->
                            <div class="row" style="margin: 15px;">
                                <h2 style="text-align: left;" onclick="show_constraints('P')">T-shirts <i class="fa-solid fa-angle-down"></i></h2>
                            </div>
                            <div class="row" id="constraints-P">
                            </div>

                            <!--Hoodies-->
                            <div class="row" style="margin: 15px;">
                                <h2 style="text-align: left;" onclick="show_constraints('S')">Hoodies <i class="fa-solid fa-angle-down"></i></h2>
                            </div>
                            <div class="row" id="constraints-S">
                            </div>

                            <!--Long-sleeved-->
                            <div class="row" style="margin: 15px;">
                                <h2 style="text-align: left;" onclick="show_constraints('M')">Long-sleeved <i class="fa-solid fa-angle-down"></i></h2>
                            </div>
                            <div class="row" id="constraints-M">
                            </div>

                            <!--Sleeveless-->
                            <div class="row" style="margin: 15px;">
                                <h2 style="text-align: left;" onclick="show_constraints('T')">Sleeveless <i class="fa-solid fa-angle-down"></i></h2>
                            </div>
                            <div class="row" id="constraints-T">
                            </div>

                            <!--Caps-->
                            <div class="row" style="margin: 15px;">
                                <h2 style="text-align: left;" onclick="show_constraints('C')">Caps <i class="fa-solid fa-angle-down"></i></h2>
                            </div>
                            <div class="row" id="constraints-C">
                            </div>

                            <button type="submit" style="float: right; border-radius: 8px; background-color: #316639; border: 0; color: white; padding: 6px; margin: 12px;">
                                Save changes
                            </button>
                        </form>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!--Embroideries tab-->
    <div class="container" style="margin-top: 20px; margin-bottom: 20px;">
        <h2 style="text-align: center; width: 100%;">Embroideries</h2>
        <form action="../controllers/php/add_embroidery.php" method="post">
            <div class="row" style="background-color: rgb(236, 236, 236); padding-top: 20px; padding-bottom: 20px;">
                <div class="col-md-6">
                    <input type="file" name="img_file" accept=".png" enctype="multipart/form-data">
                </div>
                <div class="col-md-6">            
                    <h5>Name</h5>
                    <input type="text" name="name">
                    <h5>Size</h5>
                    <select name="size">
                        <option value="1">Small</option>
                        <option value="2">Medium</option>
                        <option value="3">Large</option>
                    </select>
                    <h5>Price</h5>
                    <input type="number" name="price">
                    <h5>Tags</h5>
                    <input type="text" name="tags">
                    <button type="submit" class="product-card-button" style="float: right; margin-right: 10%; margin-top: 8px; border-radius: 8px; width: 120px; color: white;">Submit</button>
                </div>            
            </div>
        </form>
    </div>
    <script>
        $(document).ready(function(){
            $.ajax({
                url: '../controllers/php/get_orders.php',
                type: 'GET',
                success: function(response) {
                    $('#orders-table tbody').html(response);
                }
            })
        });
        
        $(document).ready(function(){
            $.ajax({
                url: '../controllers/php/get_inventory.php',
                type: 'GET',
                success: function(response) {
                    $('#inventory-table tbody').html(response);
                }
            })
        });

        function show_options(){
            document.getElementById('specs').style.setProperty('display', 'block');
        }

        function show_iadd_bar(){
            document.getElementById('item-add').style.setProperty('display', 'block');
        }

        function show_constraints(garment){
            const xhttp = new XMLHttpRequest();
            xhttp.open("POST", "../controllers/php/constraints_form.php");
            xhttp.setRequestHeader("Content-type", "application/x-www-form-urlencoded");
            xhttp.onload = function() {
                document.getElementById("constraints-" + garment).innerHTML = this.responseText;
            }
            xhttp.send("type=" + garment);
        }

        function delete_item(it_id){
            $.ajax({
                url: '../controllers/php/delete_item.php',
                type: 'POST',
                data: {
                    it_id
                }
            });
        }

        var e = document.getElementById("gar-sel");

        function onChange_sel() {
            function change_s(){
                var value = e.value;
                var xhttp = new XMLHttpRequest();
                xhttp.open("POST", "../controllers/php/get_sizes.php");
                xhttp.setRequestHeader("Content-type", "application/x-www-form-urlencoded");
                xhttp.onload = function() {
                    document.getElementById("size-sel").innerHTML = this.responseText;
                }
                xhttp.send("type=" + value);
            }
            function change_c(){
                var value = e.value;
                var xhttp = new XMLHttpRequest();
                xhttp.open("POST", "../controllers/php/get_colors.php");
                xhttp.setRequestHeader("Content-type", "application/x-www-form-urlencoded");
                xhttp.onload = function() {
                    document.getElementById("color-sel").innerHTML = this.responseText;
                }
                xhttp.send("type=" + value);
            }
            change_s();
            change_c();
        }
        e.onchange = onChange_sel;
        onChange_sel();

        function show_update() {
            document.getElementById('update-btn').style.setProperty('display', 'block');
        }
    </script>
  </body>
</html>